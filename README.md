# מאתר שירותים לגיל השלישי
## Elderly Services Finder

אפליקציה לחיפוש מידע על שירותים לאזרחים ותיקים המבוססת על קובץ האקסל שלך.

## מדריך התקנה מלא

### שלב 1: הכנת קובץ Google Sheets

1. **העלאת קובץ האקסל לדרייב**:
   - פתח את [Google Drive](https://drive.google.com)
   - לחץ על "חדש" > "העלאת קובץ"
   - בחר את קובץ האקסל שלך (SERV.xlsx)
   - פתח את הקובץ ב-Google Sheets (לחץ על הקובץ עם הלחצן הימני > פתח באמצעות > Google Sheets)

2. **הגדרת Google Apps Script**:
   - בגיליון Google Sheets, לחץ על "הרחבות" (Extensions) > "Apps Script"
   - העתק את כל הקוד מקובץ `Code.gs` שסיפקתי לך ודבק אותו בעורך הסקריפט
   - שמור את הפרויקט (לחץ על סמל הדיסקט) ותן לו שם, לדוגמה "Elderly Services API"

3. **פריסת הסקריפט כ-Web App**:
   - לחץ על "פריסה" (Deploy) > "פריסה חדשה" (New deployment)
   - בחר סוג: "אפליקציית אינטרנט" (Web app)
   - הגדר "מי יכול לגשת": "כולם" (Anyone)
   - לחץ על "פריסה" (Deploy)
   - אשר את ההרשאות כשתתבקש
   - **העתק את כתובת ה-URL** של אפליקציית האינטרנט - תצטרך אותה בהמשך!

### שלב 2: הגדרת GitHub Repository

1. **צור חשבון GitHub**:
   - גש ל-[GitHub.com](https://github.com)
   - צור חשבון חדש אם אין לך כבר אחד

2. **צור מאגר חדש**:
   - לחץ על כפתור "+" בפינה הימנית העליונה
   - בחר "מאגר חדש" (New repository)
   - תן לו שם: `elderly-services-finder`
   - ודא שהמאגר מוגדר כ"ציבורי" (Public)
   - סמן את תיבת הסימון "הוסף קובץ README" (Add a README file)
   - לחץ על "צור מאגר" (Create repository)

### שלב 3: העלאת הקבצים ל-GitHub

1. **העלאת הקבצים**:
   - במאגר החדש שלך, לחץ על "הוסף קובץ" (Add file) > "העלה קבצים" (Upload files)
   - העלה את כל הקבצים שסיפקתי לך:
     - `index.html`
     - `styles.css`
     - `app.js`
     - `sw.js`
     - `manifest.json`
   - צור תיקיית `icons` והעלה לתוכה אייקונים בגדלים 192x192 ו-512x512 (תוכל למצוא אייקונים בחינם באינטרנט)

2. **עדכון כתובת ה-API**:
   - פתח את קובץ `app.js` לעריכה (לחץ עליו ואז לחץ על סמל העיפרון)
   - מצא את השורה עם `const API_URL = 'https://script.google.com/macros/s/REPLACE_WITH_YOUR_DEPLOYED_SCRIPT_ID/exec';`
   - החלף את הכתובת בכתובת ה-URL של ה-Web App שקיבלת בשלב 1
   - גלול למטה ולחץ על "Commit changes" לשמירת השינויים

### שלב 4: הפעלת GitHub Pages

1. **הפעלת GitHub Pages**:
   - לחץ על "Settings" בחלק העליון של המאגר שלך
   - גלול למטה לסעיף "GitHub Pages"
   - תחת "Source", בחר "main branch"
   - לחץ על "Save"
   - המתן מספר דקות עד שהאתר יעלה

2. **גישה לאתר שלך**:
   - האתר שלך יהיה זמין בכתובת:
   - `https://<your-username>.github.io/elderly-services-finder/`
   - לדוגמה: `https://john-doe.github.io/elderly-services-finder/`

### שלב 5: בדיקה ושימוש

1. **בדיקת האפליקציה**:
   - פתח את האתר בטלפון הנייד או בטאבלט
   - ודא שהאפליקציה טוענת את הנתונים כראוי
   - נסה לחפש שירותים
   - בדוק את הפונקציונליות במצב לא מקוון

2. **התקנת האפליקציה על המכשיר**:
   - **באנדרואיד**: פתח את האתר בכרום > תפריט (שלוש נקודות) > "הוסף למסך הבית"
   - **באייפון**: פתח את האתר בספארי > לחץ על כפתון השיתוף > "הוסף למסך הבית"

### עדכון הנתונים בעתיד

כדי לעדכן את הנתונים באפליקציה, פשוט:
1. פתח את קובץ ה-Google Sheets
2. ערוך את המידע כרצונך (הוסף/ערוך/מחק שורות)
3. שמור את השינויים

זהו! האפליקציה תעדכן את הנתונים באופן אוטומטי כשמשתמשים יפתחו אותה או ילחצו על כפתור הרענון.

### עדכון קוד האתר (גרסה חדשה)

במקרה שתרצה לעדכן את קוד האתר (HTML, CSS, JavaScript), יש לעקוב אחר השלבים הבאים:

1. **עדכן את מספר הגרסה**:
   - פתח את קובץ `app.js` לעריכה
   - עדכן את מספר הגרסה בשורה הראשונה: `const APP_VERSION = '1.1.0';` (לדוגמה, שנה ל-'1.2.0')
   - פתח את קובץ `sw.js` לעריכה
   - עדכן את מספר הגרסה גם בקובץ זה: `const CACHE_VERSION = '1.1.0';` (לאותו ערך שהגדרת ב-app.js)

2. **העלה את הקבצים המעודכנים**:
   - פתח את הקבצים שעדכנת (למשל index.html, styles.css, app.js)
   - בצע את השינויים הרצויים
   - שמור את השינויים באמצעות "Commit changes"

3. **תוצאה**:
   - בפעם הבאה שמשתמשים יפתחו את האפליקציה, היא תזהה את שינוי הגרסה
   - הקאש הישן יימחק אוטומטית
   - המידע הישן ב-IndexedDB יימחק
   - הגרסה החדשה תיטען באופן אוטומטי

שים לב: שינוי הגרסה הכרחי כדי שהמשתמשים יקבלו את העדכונים. ללא שינוי הגרסה, ייתכן שהדפדפן ימשיך להשתמש בגרסה הישנה מהקאש.

## פתרון בעיות נפוצות

**הנתונים לא נטענים**:
- ודא שה-URL של ה-API נכון ב-`app.js`
- בדוק שאין שגיאות ב-console של הדפדפן

**דפדפנים ישנים לא תומכים**:
- האפליקציה נבנתה עבור דפדפנים מודרניים
- רצוי להשתמש בכרום, ספארי או פיירפוקס עדכניים

**המידע לא מתעדכן**:
- לחץ על כפתור הרענון באפליקציה
- נקה את ה-cache של הדפדפן
- ודא שגרסת האפליקציה עדכנית (בדוק ב-console)

**האפליקציה מציגה גרסה ישנה למרות העדכון**:
- פתח את הגדרות הדפדפן ונקה את ה-cache
- או לחץ Ctrl+F5 (או Command+Shift+R במק) לרענון מאולץ
- הגדל את מספר הגרסה ב-`app.js` וב-`sw.js`

## תמיכה טכנית

אם אתה נתקל בבעיות נוספות, תוכל:
1. לבדוק את הקוד ב-GitHub
2. לחפש מידע באינטרנט על פתרון בעיות בPWA או GitHub Pages

# שירותי+ - פלטפורמת חיפוש שירותים לגיל השלישי

## אופטימיזציות ביצועים - 2024

לאחרונה בוצעו שיפורים משמעותיים בביצועי האפליקציה, במיוחד בהיבט של קריאות API והתמודדות עם חיבורי רשת לא יציבים:

### 🚀 אופטימיזציות בצד השרת:

1. **מנגנון מתקדם למניעת קריאות כפולות** - אופטימיזציה של קריאות API דרך מנגנון Promise שמונע קריאות מקבילות לאותו נתון.
2. **טעינה בעמודים (Pagination)** - טעינת נתונים בקבוצות קטנות מ-Firestore כדי למנוע בעיות של חסימת שרת וניהול נכון של משאבים.
3. **שימוש ב-Batch Operations** - עדכון מרוכז של נתונים ב-Firestore, במיוחד כשמדובר בעדכון מיפויי שירות-תחום עניין.
4. **השהיות מתוזמנות בין קריאות** - הוספת השהיות מחושבות בין קריאות API כדי לא לעבור את מגבלות הקצב של Firebase.

### 💾 שיפורי מטמון (Caching):

1. **אחסון חכם ב-IndexedDB** - מנגנון מטמון משופר שיודע לשמור ולאחזר נתונים מקומית ללא צורך בחיבור אינטרנט.
2. **בדיקת תוקף מטמון** - מנגנון אינטליגנטי שבודק האם המטמון תקף או שיש צורך בעדכון מהשרת.
3. **טעינה עצלה (Lazy Loading)** - טעינת נתונים רק כשיש צורך בהם, למשל טעינת מיפויי שירות-תחום עניין רק בעת סינון.
4. **לוגיקת ריענון חכמה** - מנגנון החלטה מתי לרענן נתונים שכולל בדיקת חיבור, גיל נתונים, וחוסרים.

### 🔄 שיפורי ממשק משתמש:

1. **מנגנוני פידבק למשתמש** - הוספת אינדיקטורי טעינה, הודעות סטטוס והתראות על מצב רשת.
2. **תצוגת סטטוס חיבור** - הצגה ברורה של מצב החיבור לרשת ומקור הנתונים (מקומי/שרת).
3. **לחצן רענון ידני** - אפשרות למשתמש לרענן נתונים ידנית כשיש צורך בכך.
4. **אנימציות חלקות** - שיפור חוויית המשתמש עם אנימציות ומעברים חלקים בין מצבי טעינה.

### 🛠️ שיפורי תשתית:

1. **ארכיטקטורת אירועים** - שימוש במנגנון אירועים מרכזי להודעות בין רכיבים.
2. **מודולריות משופרת** - הפרדה טובה יותר בין רכיבי UI, לוגיקת נתונים, וניהול מצב.
3. **קוד מתועד** - תיעוד מקיף יותר בקוד שמסביר את מטרת כל פונקציה והלוגיקה מאחוריה.
4. **חלוקה לקבצים לוגית** - ארגון טוב יותר של הקוד בקבצים נפרדים לפי תחומי אחריות.

## תודות

תודה לכל המפתחים והתורמים שעזרו בשיפור הפרויקט!

## 🚀 Development Workflow

### Version Management and Deployment

This project includes automated scripts for version management and deployment:

#### **Version Bump**
```bash
npm run bump
```
- Increments the version number in `package.json`
- Updates version in `sw.js` (Service Worker)
- Updates version parameters in HTML files
- Updates version in `constants.js`

#### **Build and Deploy**
```bash
npm run push
```
This single command executes the complete deployment workflow:
1. **Bumps version** (`npm run bump`)
2. **Builds project** (`npm run build`)
3. **Stages changes** (`git add .`)
4. **Commits with version** (`git commit -m "v$npm_package_version"`)
5. **Pushes to repository** (`git push`)

#### **Development Server**
```bash
npm run dev
```
- Starts both backend server (port 5001) and frontend (Vite on port 5173)
- Runs concurrently: `concurrently "node server.js" "vite"`

#### **Build for Production**
```bash
npm run build
```
- Builds the project using Vite
- Runs post-build processing
- Copies critical files to `dist` folder

### **Workflow Summary**

**For regular development:**
```bash
npm run dev
```

**For version update and deployment:**
```bash
npm run push
```

**For manual version bump only:**
```bash
npm run bump
```

The `npm run push` command is the recommended way to handle version updates and deployments as it automates the entire process from version bumping to pushing to the repository.
